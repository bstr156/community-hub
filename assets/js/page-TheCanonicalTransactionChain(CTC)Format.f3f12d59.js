(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{658:function(t,e,a){t.exports=a.p+"assets/img/input-data.8ea2ea58.png"},767:function(t,e,a){"use strict";a.r(e);var i=a(2),n=Object(i.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"this-section-will-be-updated-soon-with-a-map-of-the-rollux-ctc-format-and-transaction-header-for-l1-poda-until-then-this-page-will-reflect-optimism-s-ctc-format-please-check-back-soon-for-now-refer-to-block-storage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#this-section-will-be-updated-soon-with-a-map-of-the-rollux-ctc-format-and-transaction-header-for-l1-poda-until-then-this-page-will-reflect-optimism-s-ctc-format-please-check-back-soon-for-now-refer-to-block-storage"}},[t._v("#")]),t._v(" This section will be updated soon with a map of the Rollux CTC format and transaction header for L1 PoDA. Until then, this page will reflect Optimism's CTC format. Please check back soon. For now, refer to "),e("RouterLink",{attrs:{to:"/docs/protocol/2-rollup-protocol/#block-storage"}},[t._v("Block Storage")])],1),t._v(" "),e("p",[t._v("Every transaction submitted to Optimism is written to the mainnet Ethereum blockchain as call data, this is how Optimism inherits the availability and integrity guarantees of Ethereum.\nThis is also the cause of the majority of the cost of Optimism transactions.\nAt the time of writing it is cheaper to write a kilobyte to storage on Optimism than it is to add one byte to the calldata on Ethereum.")]),t._v(" "),e("h2",{attrs:{id:"initial-solution"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#initial-solution"}},[t._v("#")]),t._v(" Initial solution")]),t._v(" "),e("p",[t._v("The initial solution was to write a header with supporting data followed by a list of transactions.")]),t._v(" "),e("p",[t._v("To interpret a transaction, you can search for it on "),e("a",{attrs:{href:"https://etherscan.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Etherscan"),e("OutboundLink")],1),t._v(".\nTo interpret a CTC transaction you need to "),e("strong",[t._v("Click to see more")]),t._v(' to see the calldata (called "Input Data" by Etherscan):')]),t._v(" "),e("p",[e("img",{attrs:{src:a(658),alt:"Transaction input data"}})]),t._v(" "),e("p",[t._v("For example, here are the fields and their values for this "),e("a",{attrs:{href:"https://etherscan.io/tx/0xf5a2dd9d0815ad4dcee00063ff8f8f3fd44b3bd8ffc1f7f6c7f7f0b4b086c5a7/advanced",target:"_blank",rel:"noopener noreferrer"}},[t._v("initial solution CTC transaction"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"right"}},[t._v("Bytes")]),t._v(" "),e("th",{staticStyle:{"text-align":"right"}},[t._v("Field Size")]),t._v(" "),e("th",[t._v("Field")]),t._v(" "),e("th",[t._v("Value")]),t._v(" "),e("th",[t._v("Comments")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("0-3")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("4")]),t._v(" "),e("td",[t._v("Function signature")]),t._v(" "),e("td",[t._v("0xd0f89344")]),t._v(" "),e("td",[e("a",{attrs:{href:"https://www.4byte.directory/signatures/?bytes4_signature=0xd0f89344",target:"_blank",rel:"noopener noreferrer"}},[t._v("appendSequencerBatch()"),e("OutboundLink")],1)])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("4-8")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("Starting tx index")]),t._v(" "),e("td",[t._v("4025992")]),t._v(" "),e("td",[e("a",{attrs:{href:"https://explorer.optimism.io/tx/4025992",target:"_blank",rel:"noopener noreferrer"}},[t._v("this transaction"),e("OutboundLink")],1)])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("9-11")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Elements to append")]),t._v(" "),e("td",[t._v("89")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("12-14")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Batch contexts")]),t._v(" "),e("td",[t._v("15")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("15-30")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("14")]),t._v(" "),e("td",[e("strong",[t._v("Context 0")]),t._v(" (multiple fields)")]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("15-17")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Transactions sent directly to L2")]),t._v(" "),e("td",[t._v("3")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("18-20")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Deposits with this context")]),t._v(" "),e("td",[t._v("0")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("21-25")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("Timestamp")]),t._v(" "),e("td",[t._v("1646146436")]),t._v(" "),e("td",[e("code",[t._v("block.timestamp")]),t._v(" for transactions in this context (Tue Mar 01 2022 14:53:56 UTC)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("26-30")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("L1 block number")]),t._v(" "),e("td",[t._v("The L1 block number in this context, as obtained by calling "),e("a",{attrs:{href:"https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts/contracts/L2/predeploys/iOVM_L1BlockNumber.sol",target:"_blank",rel:"noopener noreferrer"}},[t._v("OVM_L1BlockNumber"),e("OutboundLink")],1),t._v(". ("),e("a",{attrs:{href:"https://etherscan.io/block/14301739",target:"_blank",rel:"noopener noreferrer"}},[t._v("14301739"),e("OutboundLink")],1),t._v(")")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("31-46")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("14")]),t._v(" "),e("td",[e("strong",[t._v("Context 1")])]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("31-33")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Transactions sent directly to L2")]),t._v(" "),e("td",[t._v("8")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("34-36")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Deposits")]),t._v(" "),e("td",[t._v("0")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("37-41")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("Timestamp")]),t._v(" "),e("td",[t._v("1646146451")]),t._v(" "),e("td",[t._v("15 seconds after the previous batch")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("42-47")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("L1 block number")]),t._v(" "),e("td",[e("a",{attrs:{href:"https://etherscan.io/block/14301739",target:"_blank",rel:"noopener noreferrer"}},[t._v("14301739"),e("OutboundLink")],1)]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("16n+15-16n+30")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("14")]),t._v(" "),e("td",[e("strong",[t._v("Context n")])]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("16n+15-16n+17")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Transactions sent directly to L2")]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("16n+18-16n+20")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("3")]),t._v(" "),e("td",[t._v("Deposits with this context")]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("16n+21-16n+25")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("Timestamp")]),t._v(" "),e("td"),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"right"}},[t._v("16n+26-16n+30")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("5")]),t._v(" "),e("td",[t._v("L1 block number")]),t._v(" "),e("td"),t._v(" "),e("td")])])]),t._v(" "),e("p",[t._v("This transaction has 15 batch contexts (numbered 0-14), so the first byte after the last context in this transaction, which starts the transaction list, is "),e("code",[t._v("16*15+15=255")]),t._v(".\nTransactions are provided as a three byte length followed by the RLP encoded transaction.")]),t._v(" "),e("p",[t._v("Looking at locations 255-257, we see "),e("code",[t._v("0x00016e")]),t._v(", so the first transaction is 366 bytes long, at locations 258-623.\nThe next transaction length starts at byte 624, and the next transaction itself starts at byte 627.")]),t._v(" "),e("h2",{attrs:{id:"additional-batch-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#additional-batch-types"}},[t._v("#")]),t._v(" Additional batch types")]),t._v(" "),e("p",[t._v("The initial solution did not have a batch type.\nHowever, to modify the format (for example, to add compression) a batch type is needed.\nThe solution is to set the timestamp of the first context to zero.\nThis does not create ambiguity because a timestamp of zero represents January 1st, 1970 (based on the UNIX convention), which cannot happen.\nThe block number then represents the transaction type.")]),t._v(" "),e("h2",{attrs:{id:"ctc-transaction-type-zero"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ctc-transaction-type-zero"}},[t._v("#")]),t._v(" CTC transaction type zero")]),t._v(" "),e("p",[t._v("After the normal header and the first context, which has a timestamp of zero and a block number of zero, the other contexts contain the normal data.\nAfter that the list of transaction lengths and transaction data is compressed using "),e("a",{attrs:{href:"https://nodejs.org/api/zlib.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("zlib"),e("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);e.default=n.exports}}]);